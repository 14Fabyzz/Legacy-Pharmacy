<div class="page-container">
  <header class="page-header">
    <h2>PRODUCTOS EN ALMACEN</h2>
    <p>En el m√≥dulo PRODUCTOS podr√° agregar nuevos productos al sistema, actualizar datos de los productos y mucho m√°s.</p>
  </header>

  
  <nav class="tabs-nav">
    <a routerLink="/app/productos/nuevo">NUEVO PRODUCTO</a>
    <a routerLink="/app/productos/almacen" routerLinkActive="active">PRODUCTOS EN ALMACEN</a>
  </nav>

  <div class="search-container">
     <input 
       type="text" 
       class="search-input" 
       placeholder="Buscar producto por nombre, c√≥digo, SKU..."
       [(ngModel)]="searchTerm">
   </div>

  <ng-container *ngIf="products$ | async | search:searchTerm as filteredProducts">
    
    <div class="product-list-container">
      
      <!-- Iteramos sobre los productos filtrados -->
      <div *ngFor="let product of filteredProducts" class="product-card">
        
        <div class="product-image">
          <div class="image-placeholder"></div>
        </div>

        <div class="product-info-wrapper">
          <div class="product-header">
            <!-- CORREGIDO: Usamos 'idCodigo' en lugar de 'id' -->
            <span class="product-id">{{ product.idCodigo }}</span>
            <!-- CORREGIDO: Usamos 'nombre' en lugar de 'name' -->
            <h3 class="product-name">{{ product.nombre }}</h3>
          </div>

          <div class="product-details-grid">
            <!-- CORREGIDO: Usamos 'codigoBarras' en lugar de 'barcode' -->
            <div class="info-item"><dt>C√≥digo de barras:</dt><dd>{{ product.codigoBarras }}</dd></div>
            
            <!-- CORREGIDO: Usamos 'precioVenta' en lugar de 'price' -->
            <div class="info-item"><dt>Precio:</dt><dd>{{ product.precioVenta | currency }}</dd></div>
            
            <!-- A√ëADIDO: Mostramos las propiedades que s√≠ existen -->
            <div class="info-item"><dt>IVA:</dt><dd>{{ product.ivaPorcentaje }}%</dd></div>
            <div class="info-item"><dt>Laboratorio ID:</dt><dd>{{ product.laboratorioId }}</dd></div>

            <!-- ELIMINADOS: Los campos 'codigo', 'available', 'sold', 'discount', 'expiry' y 'status'
                 no existen en tu 'interface', por lo que han sido removidos. -->
          </div>
        </div>

        <div class="product-actions">
          <span>OPCIONES:</span>
          <div class="action-icons">
            <a title="Informaci√≥n detallada">üëÅÔ∏è</a>
            <a title="Gestionar imagen">üñºÔ∏è</a>
            <a title="Kardex del producto">üìä</a>
            
            <!-- CORREGIDO: El enlace de editar debe usar el 'idCodigo' -->
            <a title="Actualizar producto" [routerLink]="['/app/productos/editar', product.idCodigo]">‚úèÔ∏è</a>
            
            <a title="Eliminar producto">üóëÔ∏è</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensaje de no resultados (sin cambios, esto est√° bien) -->
    <div class="no-results" *ngIf="filteredProducts.length === 0">
      <p>No se encontraron productos que coincidan con "{{ searchTerm }}"</p>
    </div>
  </ng-container>

</div>