<div class="page-container">
    <header class="page-header">
        <div class="header-content">
            <div>
                <h2>CONSULTA DE PRECIOS</h2>
                <p>Escanee el c√≥digo de barras o escriba el nombre del producto.</p>
            </div>
        </div>
    </header>

    <!-- Navegaci√≥n Compartida -->
    <nav class="tabs-nav">
        <a routerLink="/app/productos/almacen" routerLinkActive="active">
            <span class="nav-icon">üì¶</span> ALMAC√âN
        </a>

        <a routerLink="/app/productos/consulta" routerLinkActive="active">
            <span class="nav-icon">üîç</span> CONSULTA
        </a>

        <a routerLink="/app/productos/vencimientos" routerLinkActive="active">
            <span class="nav-icon">üö®</span> MONITOR ALERTAS
        </a>

        <a routerLink="/app/productos/entrada-mercancia" routerLinkActive="active">
            <span class="nav-icon">üöö</span> ENTRADAS
        </a>

        <a routerLink="/app/productos/auditoria" routerLinkActive="active">
            <span class="nav-icon">üìã</span> AUDITOR√çA
        </a>

        <a routerLink="/app/productos/nuevo" routerLinkActive="active">
            <span class="nav-icon">‚ú®</span> NUEVO
        </a>
    </nav>

    <div class="search-layout">

        <!-- √ÅREA DE B√öSQUEDA -->
        <div class="search-box-container">
            <div class="input-wrapper">
                <span class="search-icon">üîç</span>
                <input type="text" #searchInput class="param-search-input"
                    placeholder="Escanee c√≥digo o escriba nombre..." [(ngModel)]="searchTerm" (input)="onSearch($event)"
                    (keyup.enter)="onEnter()">
                <button *ngIf="searchTerm" class="clear-btn" (click)="clearSearch()">√ó</button>
            </div>

            <!-- LISTA DE SUGERENCIAS -->
            <div class="suggestions-dropdown" *ngIf="filteredSuggestions.length > 0">
                <div *ngFor="let p of filteredSuggestions" class="suggestion-item" (click)="selectProduct(p)">
                    <div class="sugg-name">{{ p.nombre_comercial }}</div>
                    <div class="sugg-meta">{{ p.concentracion }} - {{ p.laboratorio_nombre }}</div>
                </div>
            </div>
        </div>

        <!-- RESULTADO: PRODUCTO ENCONTRADO -->
        <div class="result-card bounce-in" *ngIf="selectedProduct">
            <div class="product-detail-grid">

                <!-- Imagen -->
                <div class="product-image-col">
                    <div class="image-box">
                        <img *ngIf="selectedProduct.imagenUrl" [src]="selectedProduct.imagenUrl" alt="Producto">
                        <span *ngIf="!selectedProduct.imagenUrl" class="no-img-icon">üíä</span>
                    </div>
                </div>

                <!-- Info Principal -->
                <div class="product-info-col">
                    <h1 class="main-title">{{ selectedProduct.nombre_comercial }}</h1>
                    <span class="subtitle">{{ selectedProduct.concentracion }} | {{ selectedProduct.presentacion
                        }}</span>

                    <div class="meta-tags">
                        <span class="tag lab">{{ selectedProduct.laboratorio_nombre }}</span>

                        <span class="tag stock" [ngClass]="{'low': (selectedProduct.stock_actual || 0) < 5}">
                            Stock: {{ selectedProduct.stock_actual }}
                        </span>
                    </div>

                    <div class="price-display">
                        <small>Precio P√∫blico</small>
                        <div class="big-price">{{ selectedProduct.precio_venta_base | currency:'USD':'symbol':'1.0-0' }}
                        </div>
                    </div>
                </div>

            </div>

            <div class="card-footer">
                <button class="btn-reset" (click)="clearSearch()">Nueva Consulta (ESC)</button>
            </div>
        </div>

        <!-- ESTADO: NO ENCONTRADO -->
        <div class="not-found-state" *ngIf="notFound">
            <div class="icon">ü§∑‚Äç‚ôÇÔ∏è</div>
            <h3>Producto no encontrado</h3>
            <p>Intenta con otro c√≥digo o nombre.</p>
        </div>

        <!-- ESTADO: ESPERANDO (INICIAL) -->
        <div class="waiting-state" *ngIf="!selectedProduct && !notFound">
            <p>Esperando lectura de c√≥digo...</p>
        </div>

    </div>
</div>